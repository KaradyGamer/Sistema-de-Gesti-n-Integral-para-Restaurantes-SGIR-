{% extends "admin/base_site.html" %}
{% load static %}

{% block title %}Reportes y An치lisis - Paprika{% endblock %}

{% block content %}
    <h1>游늵 Dashboard de Reportes - Paprika</h1>
    
    <!-- Controles de exportaci칩n -->
    <div class="export-controls" style="margin: 20px 0; padding: 15px; background: #f8f9fa; border-radius: 8px;">
        <h3>游늯 Exportar Reportes</h3>
        <div style="display: flex; gap: 10px; margin-top: 10px;">
            <a href="{% url 'reportes:reporte_pdf' %}" class="button" style="background: #dc3545; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px;">
                游늯 Ver Reporte
            </a>
            <button onclick="actualizarDatos()" style="background: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer;">
                游댃 Actualizar Datos
            </button>
        </div>
    </div>

    <!-- M칠tricas principales -->
    <div class="metrics-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin: 20px 0;">
        <div class="metric-card" style="background: #e8f5e9; padding: 20px; border-radius: 8px; text-align: center;">
            <h4 style="margin: 0; color: #2e7d32;">Total Ventas</h4>
            <div id="totalVentas" style="font-size: 24px; font-weight: bold; color: #1b5e20;">Bs/ 0.00</div>
        </div>
        <div class="metric-card" style="background: #e3f2fd; padding: 20px; border-radius: 8px; text-align: center;">
            <h4 style="margin: 0; color: #1976d2;">Total Pedidos</h4>
            <div id="totalPedidos" style="font-size: 24px; font-weight: bold; color: #0d47a1;">0</div>
        </div>
        <div class="metric-card" style="background: #fff3e0; padding: 20px; border-radius: 8px; text-align: center;">
            <h4 style="margin: 0; color: #f57c00;">Promedio/Pedido</h4>
            <div id="promedioPedido" style="font-size: 24px; font-weight: bold; color: #e65100;">Bs/ 0.00</div>
        </div>
    </div>

    <!-- Gr치ficos -->
    <div class="charts-container" style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin: 30px 0;">
        
        <!-- Gr치fico de ventas por d칤a -->
        <div class="chart-container" style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
            <h3 style="text-align: center; color: #333;">游늳 Ventas por D칤a (Semana Actual)</h3>
            <canvas id="ventasChart" width="400" height="300"></canvas>
        </div>

        <!-- Gr치fico de productos top -->
        <div class="chart-container" style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
            <h3 style="text-align: center; color: #333;">游끥 Top 5 Productos M치s Vendidos</h3>
            <canvas id="productosChart" width="400" height="300"></canvas>
        </div>
    </div>

    <!-- An치lisis inteligente -->
    <div class="analysis-container" style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #28a745;">
        <h3 style="color: #333; margin-top: 0;">游뱄 An치lisis Inteligente</h3>
        <div id="analisisInteligente" style="font-size: 16px; line-height: 1.6; color: #555;">
            Cargando an치lisis...
        </div>
    </div>

    <!-- Tabla de productos detallada -->
    <div class="table-container" style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin: 20px 0;">
        <h3 style="color: #333;">游늶 Detalle de Productos (Semana Actual)</h3>
        <table id="productosTable" style="width: 100%; border-collapse: collapse;">
            <thead>
                <tr style="background: #f8f9fa;">
                    <th style="padding: 12px; border: 1px solid #ddd; text-align: left;">Producto</th>
                    <th style="padding: 12px; border: 1px solid #ddd; text-align: center;">Cantidad</th>
                    <th style="padding: 12px; border: 1px solid #ddd; text-align: center;">Ingresos</th>
                    <th style="padding: 12px; border: 1px solid #ddd; text-align: center;">% del Total</th>
                </tr>
            </thead>
            <tbody id="productosTableBody">
                <tr>
                    <td colspan="4" style="padding: 20px; text-align: center; color: #666;">Cargando datos...</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<!-- Chart.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
<script src="{% static 'js/admin/reportes/dashboard.js' %}?v=10.0"></script>
{% endblock %}